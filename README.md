# s3_bucket_permission_vulnerability

Unlike many AWS resources, s3 bucket arns do not include the resource account number. Therefore, IAM policies that allow or deny access can only specify the bucket name.

![Alt text](img/Slide1.jpg?raw=true "Typical Configuration")

For most other AWS services, a user in one account would have to actively assume a role into another account for cross-account access. This is not the case for S3 bucket access. 

Bucket names are globally unique in AWS. When a name is deleted, it becomes available for another AWS user (after a substantial delay ~1 hour).

If an S3 bucket is deleted, another account can intercept the objects/files sent to that bucket. For example, a lambda could continue to write sensitive information to the bucket name that now belongs to another account. 

With an account number and an S3 bucket name, a malicious user could create a private bucket and give permission only to the target account.

Again, because the lambda does not have to assume any role to write into another account's S3 bucket, the lambda's existing IAM permission to access the bucket by name would continue to allow access.

![Alt text](img/Slide2.jpg?raw=true "Malicious Configuration")

AWS acknowledges this vulnerability: [https://docs.aws.amazon.com/AmazonS3/latest/user-guide/delete-bucket.html](https://docs.aws.amazon.com/AmazonS3/latest/user-guide/delete-bucket.html), stating simply:

"If the bucket receives log data from Elastic Load Balancing (ELB): We recommend that you stop the delivery of ELB logs to the bucket before deleting it. After you delete the bucket, if another user creates a bucket using the same name, your log data could potentially be delivered to that bucket."


 
